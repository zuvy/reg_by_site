[
    ~[tlist_sql;
        SELECT 
            Prefs.Name AS pref_name,
            Prefs.Value AS number_of_teachers,
            SUBSTR(Prefs.Name, -3) AS school_id,
            Schools.Name AS school_name,
            REGEXP_SUBSTR(Prefs.Name, 'rc-(-?\d+)-', 1, 1, NULL, 1) AS grade_level
        FROM Prefs
        JOIN Schools ON Schools.School_Number = SUBSTR(Prefs.Name, -3)
        WHERE Prefs.Name LIKE '%teachers-rc%'
        ORDER BY Schools.Name, grade_level;]
    {
        "pref_name": "~(pref_name)",
        "number_of_teachers": "~(number_of_teachers)",
        "school_id": "~(school_id)",
        "school_name": "~(school_name)",
        "grade_level": "~(grade_level)"
    },
[/tlist_sql]
{}]