[
    ~[tlist_sql;
  SELECT
    CASE WHEN GROUPING(sch.School_Number)=1 THEN 'ALL SCHOOLS' ELSE sch.Name END AS school_name,
    CASE WHEN GROUPING(sch.School_Number)=1 THEN NULL ELSE sch.School_Number END AS school_id,
    COUNT(DISTINCT CASE WHEN s.Grade_Level = -1 THEN s.ID END) AS enrolled_prek,
    COUNT(DISTINCT CASE WHEN s.Grade_Level = 0  THEN s.ID END) AS enrolled_k,
    COUNT(DISTINCT CASE WHEN s.Grade_Level = 1  THEN s.ID END) AS enrolled_1,
    COUNT(DISTINCT CASE WHEN s.Grade_Level = 2  THEN s.ID END) AS enrolled_2,
    COUNT(DISTINCT CASE WHEN s.Grade_Level = 3  THEN s.ID END) AS enrolled_3,
    COUNT(DISTINCT CASE WHEN s.Grade_Level = 4  THEN s.ID END) AS enrolled_4,
    COUNT(DISTINCT CASE WHEN s.Grade_Level = 5  THEN s.ID END) AS enrolled_5,
    COUNT(DISTINCT s.ID) AS total_enrolled
  FROM CC
  JOIN Students s  ON s.ID = cc.StudentID
  JOIN Sections se ON se.ID = cc.SectionID
  JOIN Schools sch ON sch.School_Number = cc.SchoolID
  JOIN CodeSet cs  ON cs.CodeSetID = sch.SchoolCategoryCodeSetID AND cs.Code = 'ELEM'
  WHERE cc.TermId = 3500
    AND se.External_Expression = 'AM-PM(A)'
    AND s.Grade_Level IN (-1,0,1,2,3,4,5)
    AND s.Enroll_Status = 0
  GROUP BY GROUPING SETS ( (sch.School_Number, sch.Name), () )
  ORDER BY school_id NULLS LAST;]
  {
    "school_name": "~(school_name)",
    "school_id": "~(school_id)",
    "enrollment": {
      "prek": "~(enrolled_prek)",
      "k": "~(enrolled_k)",
      "grade_1": "~(enrolled_1)",
      "grade_2": "~(enrolled_2)",
      "grade_3": "~(enrolled_3)",
      "grade_4": "~(enrolled_4)",
      "grade_5": "~(enrolled_5)",
      "total": "~(total_enrolled)"
    }
  },

[/tlist_sql]
{}]